
<form class="worldbuilder-form page-container">
<!-- Tab Navigation -->
<header class="window-header general-header">
  <nav class="tabs" data-group="worldbuilder-tabs">
    <a class="item active" data-tab="main">
      <i class="fas fa-globe"></i>
      Main
    </a>
    <a class="item" data-tab="lairs">
      <i class="fas fa-dungeon"></i>
      Lairs
    </a>
    <a class="item" data-tab="towns">
      <i class="fas fa-castle"></i>
      Towns
    </a>
    <a class="item" data-tab="treasure">
      <i class="fas fa-gem"></i>
      Treasure
    </a>
    <a class="item" data-tab="magic-items">
      <i class="fas fa-hat-wizard"></i>
      Magic Items
    </a>
    <a class="item" data-tab="traps">
      <i class="fas fa-skull-crossbones"></i>
      Traps
    </a>
    <a class="item" data-tab="actors">
      <i class="fas fa-users"></i>
      Actors
    </a>
  </nav>
  <div class="tab-separator"></div>
</header>



<!-- Tab Content -->

<section class="tab-content" data-tab="main">
  <div class="scrollable-container content"></div>

    <h3>Main</h3>
  <!-- Population Density Dropdown -->
  <div>
    <label for="population-density-select">Population Density:</label>
    <select class="population-density-select" name="population-density">
      {{#each populationDensityOptions}}
      <option value="{{this.value}}" {{#if (eq ../populationDensity this.value)}}selected{{/if}}>{{this.label}}</option>
      {{/each}}
    </select>
  </div>

  <!-- Climate Type Dropdown -->
  <div>
    <label for="climate-select">Climate Type:</label>
    <select class="climate-select" name="climate-type">
      {{#each climateTypeOptions}}
      <option value="{{this.value}}" {{#if (eq ../climateType this.value)}}selected{{/if}}>{{this.label}}</option>
      {{/each}}
    </select>
  </div>

  <!-- Icon Button Table -->
  <table class="icon-button-table">
    <tr>
      <td>
        <button type="button" class="icon-button terrain-roll" title="Roll for Terrain">
          <i class="fas fa-dice"></i>
        </button>
      </td>
      <td>
        <button type="button" class="icon-button feature-type-roll" title="Roll for Feature Type">
          <i class="fa-solid fa-dice-d20"></i>
        </button>
      </td>
      <td>
        <button type="button" class="icon-button encounter-roll" title="Roll for Encounter">
          <i class="fas fa-dice-d10"></i><i class="fas fa-dice-d10"></i>
        </button>
      </td>
    </tr>
<tr>
  <td style="text-align: center;">Terrain</td>
  <td style="text-align: center;">Feature Type</td>
  <td style="text-align: center;">Encounter</td>
</tr>

  </table>

  <!-- Terrain Type Dropdown -->
  <div class="form-group">
    <label for="terrain-select">Terrain Type</label>
    <select class="terrain-select" name="terrain-select">
      {{#each terrainTypeOptions}}
      <option value="{{this.value}}" {{#if (eq ../terrainType this.value)}}selected{{/if}}>
        {{this.label}}
      </option>
      {{/each}}
    </select>
  </div>

  <!-- Feature Type Dropdown -->
  <div class="form-group">
    <label for="feature-type-select">Feature Type</label>
    <select class="feature-type-select" name="feature-type-select">
      {{#each featureTypeOptions}}
      <option value="{{this.value}}" {{#if (eq ../featureType this.value)}}selected{{/if}}>{{this.label}}</option>
      {{/each}}
    </select>
  </div>

  <!-- Sub Feature Type Dropdown -->
  <div class="form-group">
    <label for="sub-feature-type-select">Sub-Feature Type</label>
    <select class="sub-feature-type-select" name="sub-feature-type-select" {{#if subFeatureTypeOptions.length}} {{else}} disabled{{/if}}>
      {{#each subFeatureTypeOptions}}
      <option value="{{this.value}}" {{#if (eq ../subFeatureType this.value)}}selected{{/if}}>{{this.label}}</option>
      {{/each}}
    </select>
  </div>

  <!-- Selected Terrain Information Table -->
  <div class="form-group">
    <table class="terrain-info-table">
      <thead>
        <tr>
          <td style="text-align: center;">Selected Terrain</td>
          <td style="text-align: center;">Ruggedness</td>
          <td style="text-align: center;">Travel Time</td>
          <td style="text-align: center;">Encounter Frequency</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: center;">{{terrainType}}</td>
          <td style="text-align: center;">{{ruggedness}}</td>
          <td style="text-align: center;">{{travelTime}}</td>
          <td style="text-align: center;">{{encounterFrequency}}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Encounter Information -->
  {{#if encounterResult}}
  <div class="form-group">
    <table class="encounter-info-table">
      <thead>
        <tr>
          <th>Encounter Result</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{{encounterResult}}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  {{/if}}

  <!-- Feature Information -->
  <div class="form-group feature-type-section">
    <table class="feature-info-table">
      <thead>
        <tr>
          <th>Feature Type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            {{#if featureType}}{{featureType}}{{else}}No Feature Selected. Please select a feature type.{{/if}}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

    <!-- Feature Details -->
    <div class="form-group feature-details-section">
      <table class="feature-info-table">
        <thead>
          <tr>
            <th colspan="2">{{#if featureDetails.title}}{{featureDetails.title}}{{else}}Feature Details{{/if}}</th>
          </tr>
        </thead>
        <tbody>
          {{#if featureDetails.results}}
            {{#each featureDetails.results}}
            <tr>
              <td>{{this}}</td>
            </tr>
            {{/each}}
          {{else}}
            <tr>
              <td colspan="2">No details available. Select a sub-feature to view details.</td>
            </tr>
          {{/if}}
        </tbody>
      </table>
    </div>
</section>

<!-- Lairs, Dungeons and Caves Section -->
<section class="tab-content" data-tab="lairs" style="display: none;">
  <h3>Lairs</h3>
  <button class="add-room">Add Room/Corridor</button>
  <div class="room-list">
    {{#each lairRooms}}
    <div class="room-entry">
      <h4 class="wb-header collapsible {{#if this.collapsed}}collapsed{{/if}}" data-index="{{@index}}">
        Room {{@index}}
      </h4>
      <div class="room-details" style="display: {{#if this.collapsed}}none{{else}}block{{/if}};">
            <label for="lair-room-description-{{@index}}">Description</label>
            <textarea id="lair-room-description-{{@index}}" class="lair-room-description" data-index="{{@index}}">
              {{this.lairRoomDescription}}
            </textarea>

            <label for="lair-room-notes-{{@index}}">Notes</label>
            <textarea id="lair-room-notes-{{@index}}" class="lair-room-notes" data-index="{{@index}}">
              {{this.lairRoomNotes}}
            </textarea>

            <label for="lair-room-secrets-{{@index}}">Secrets</label>
            <textarea id="lair-room-secrets-{{@index}}" class="lair-room-secrets" data-index="{{@index}}">
              {{this.lairRoomSecrets}}
            </textarea>

        <label for="features-select">Features</label>
        <select class="features-select" data-index="{{@index}}">
          {{#each ../../featureOptions}}
          <option value="{{this}}" {{#if (eq ../features.[0] this)}}selected{{/if}}>{{this}}</option>
          {{/each}}
        </select>




<!-- Lair Room Encounters -->
<div class="encounter-section">
  <label for="encounters-select-{{@index}}">Encounters</label>
  <div class="encounters-container" data-index="{{@index}}">
    <table class="encounters-table">
      <thead>
        <tr>
          <th></th>
          <th>Encounter Stat Block</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each this.encounters}}
          <tr>
            <td>
              <select class="encounters-select" data-encounter-index="{{@index}}">
                {{#each ../../encounterOptions}}
                  <option value="{{this}}" {{#if (eq ../result this)}}selected{{/if}}>{{this}}</option>
                {{/each}}
              </select>
            </td>
            <td class="encounter-statblock">
              {{{this.statblock}}} <!-- Render pre-formatted HTML for the stat block -->
            </td>
            <td>
              <button class="randomize-encounter" title="Randomize">
                <i class="fa fa-random"></i>
            </td>
              </button>
            <td>
              <button class="remove-encounter" title="Remove">
                <i class="fa fa-trash"></i>
              </button>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
    <button class="add-encounter">Add Encounter</button>
  </div>
</div>




      <button class="randomize-trap">Randomize</button>
      <button class="trap-builder">Open Trap Builder</button>
      <label for="treasure-select">Treasure</label>
      <select class="treasure-select">
        {{#each treasureOptions}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
      <button class="randomize-treasure">Randomize</button>
      <button class="treasure-builder">Open Treasure Builder</button>
    </div>
    {{/each}}
  </div>
</section>



  <!-- Settlement Tab -->
<section class="tab-content" data-tab="towns" style="display: none;">
  <h3>Towns</h3>
  <button class="add-town">Add Town</button>
  <div class="town-list">
    {{#each towns}}
    <div class="town-entry">
      <h4>Town {{@index}}</h4>
      <textarea class="town-description" placeholder="Description">{{this.description}}</textarea>
      <textarea class="town-notes" placeholder="Notes">{{this.notes}}</textarea>
      <label for="town-features-select">Features</label>
      <select class="town-features-select">
        {{#each townFeaturesOptions}}
        <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
      <button class="randomize-town-feature">Randomize</button>
    </div>
    {{/each}}
  </div>
</section>

  <!-- Treasure Tab -->
<section class="tab-content" data-tab="treasure" style="display: none;">
  <h3>Treasure</h3>
  <button class="add-treasure">Add Treasure</button>
  <div class="treasure-list">
    {{#each treasures}}
    <div class="treasure-entry">
      <h4>Treasure {{@index}}</h4>
      <textarea class="treasure-description" placeholder="Description">{{this.description}}</textarea>
      <button class="randomize-treasure">Randomize</button>
      <button class="treasure-builder">Open Treasure Builder</button>
    </div>
    {{/each}}
  </div>
</section>

  <!-- Magic Items Tab -->
<section class="tab-content" data-tab="magic-items" style="display: none;">
  <h3>Magic Items</h3>
  <button class="add-magic-item">Add Magic Item</button>
  <div class="magic-item-list">
    {{#each magicItems}}
    <div class="magic-item-entry">
      <h4>Magic Item {{@index}}</h4>
      <textarea class="magic-item-description" placeholder="Description">{{this.description}}</textarea>
      <button class="randomize-magic-item">Randomize</button>
      <button class="magic-item-builder">Open Magic Item Builder</button>
    </div>
    {{/each}}
  </div>
</section>

  <!-- Traps/Hazards Tab -->
<section class="tab-content" data-tab="traps" style="display: none;">
  <h3>Traps</h3>
  <button class="add-trap">Add Trap</button>
  <div class="trap-list">
    {{#each traps}}
    <div class="trap-entry">
      <h4>Trap {{@index}}</h4>
      <textarea class="trap-description" placeholder="Description">{{this.description}}</textarea>
      <button class="randomize-trap">Randomize</button>
      <button class="trap-builder">Open Trap Builder</button>
    </div>
    {{/each}}
  </div>
</section>

  <!-- Actors Tab -->
<section class="tab-content" data-tab="actors" style="display: none;">
  <h3>Actors</h3>
  <button class="add-actor">Add Actor</button>
  <div class="actor-list">
    {{#each actors}}
    <div class="actor-entry">
      <h4>Actor {{@index}}</h4>
      <textarea class="actor-description" placeholder="Description">{{this.description}}</textarea>
      <button class="randomize-actor">Randomize</button>
      <button class="actor-builder">Open Actor Builder</button>
    </div>
    {{/each}}
  </div>
</section>


<!-- templates/partials/footer.hbs -->
  <div class="tab-separator"></div>
  <p></p>


</form>

<footer class="wb-general-footer">
  <!-- Save and Journal Buttons -->
  <div class="form-actions">
<button type="button" class="save-entry wb-general-footer">
  <i class="fas fa-save"></i> Save
</button>
<button type="button" class="create-journal wb-general-footer">
  <i class="fas fa-book"></i> Create Journal Entry
</button>
  </div>
</footer>

